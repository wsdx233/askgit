# AskGit: Intelligently Explore Git Repos with LLMs

AskGit is a command-line tool that empowers you to leverage the power of Large Language Models (LLMs) to understand your Git repositories by "asking" questions. With two powerful modes – Retrieval-Augmented Generation (RAG) and Full Project Context mode – AskGit can help you comprehend codebases, find information, and even generate documentation.

## Features

- **Intelligent Q&A:** Ask natural language questions about your codebase and receive LLM-generated answers.

- **Two Q&A Modes:**

  - **RAG Mode (Recommended):** Scans your repository to create a knowledge base (using FAISS vector store), then utilizes Retrieval-Augmented Generation (RAG) techniques to provide only relevant code snippets to the LLM, enhancing efficiency and accuracy.

  - **Full Project Context Mode:** Sends the entire content of your Git repository (non-binary files) as context to the LLM. Suitable for small projects or scenarios requiring a comprehensive project overview (may consume a large number of tokens).

- **Multi-Turn Research Mode:** Enter an interactive session where you can ask continuous questions, and the LLM will remember previous conversation history.

- **Documentation Generation:** Save Q&A results directly as Markdown documents.

- **Configurable LLM and Embedding Providers:** Supports OpenAI and Google Gemini models.

- **Git-Aware:** Automatically detects the Git repository root and processes only Git-tracked files.

## Installation

### Using Binaries (Recommended)

Download the corresponding binary from releases and place it in your PATH.

### From Source

1. **Clone the repository (if applicable) or download the `askgit.py` file.**

   ```bash
   git clone https://github.com/your-username/askgit.git # If it's an open-source project
   cd askgit
   ```

2. **Install necessary Python dependencies:**

   ```bash
   pip install langchain langchain-openai faiss-cpu tiktoken python-dotenv configparser tqdm
   ```

   - If you plan to use **Google Gemini** models, you'll also need to install:

     ```bash
     pip install langchain-google-genai
     ```

## Configuration

The first time you run `askgit.py` within a Git repository, it will automatically guide you through the configuration process and save your settings in the `.askgit/config.ini` file.

1. **Navigate into your Git repository directory:**

   ```bash
   cd /path/to/your/git/repo
   ```

2. **Run for the first time (e.g., run the `scan` command):**

   ```bash
   askgit scan
   ```

   The program will prompt you to choose the API provider for your LLM and Embedding models (OpenAI or Gemini) and enter the corresponding API keys and model names.

   **`config.ini` Example:**

   ```ini
   [GENERAL]
   ASSISTANT_API_PROVIDER = openai
   EMBEDDING_API_PROVIDER = openai
 
   [OPENAI]
   API_KEY = sk-YOUR_OPENAI_API_KEY
   BASE_URL = https://api.openai.com/v1
   ASSISTANT_MODEL = gpt-4o
   EMBEDDING_MODEL = text-embedding-3-small
 
   ; [GEMINI]
   ; API_KEY = YOUR_GEMINI_API_KEY
   ; ASSISTANT_MODEL = gemini-1.5-pro-latest
   ; EMBEDDING_MODEL = models/embedding-001
   ```

   - **`ASSISTANT_API_PROVIDER`**: The LLM provider for Q&A and research modes.

   - **`EMBEDDING_API_PROVIDER`**: The provider used for generating embeddings in RAG mode.

   - **API Keys:** Ensure your API keys are valid. It's recommended to manage sensitive information using environment variables rather than directly writing to the configuration file.

   - **Model Names:** You may need to adjust model names based on the model and service you are using (e.g., OpenAI's `gpt-4o`, Gemini's `gemini-1.5-pro-latest`).

## Usage

Run `askgit.py` from the root directory of your Git repository.

### 1. `scan`: Scan Repository and Build RAG Knowledge Base

This is a **prerequisite** for using RAG mode Q&A and research. This command traverses files in your Git repository (skipping binary files), chunks text content, generates embeddings, and stores them as a FAISS vector database.

```bash
askgit scan
```

**Note:**

- This may take some time, depending on your repository size.

- This command will create `.askgit/db/git_kb.faiss` and `.askgit/db/git_kb.pkl` files to store the knowledge base.

### 2. `ask`: Ask a Single Question

Ask a one-off question about your repository.

- **RAG Mode (Default, Recommended):** Utilizes the knowledge base generated by `scan`.

  ```bash
  askgit ask "How does this project handle user authentication?"
  ```

- **Full Project Context Mode:** Sends the entire repository content (non-binary files) to the LLM. Suitable for small projects or questions requiring a global perspective. **Please note:** This can lead to high token consumption and longer response times, and may exceed the model's context limit for very large projects.

  ```bash
  askgit ask --whole "Please give me a high-level overview of the project architecture."
  ```

### 3. `research`: Enter Multi-Turn Research Mode

Enter an interactive session where you can ask continuous questions, and the LLM will remember the conversation history.

- **RAG Mode (Default, Recommended):**

  ```bash
  askgit research
  ```

  Type your questions at the prompt. Type `exit` or `quit` to end the session.

- **Full Project Context Mode:**

  ```bash
  askgit research --whole
  ```

  Similarly, type `exit` or `quit` to end the session. Be mindful of potential token consumption in this mode.

### 4. `doc`: Generate Markdown Documentation from Q&A Results

Generate a Markdown document based on your question and the LLM's answer, saving it to the `.askgit/docs/` directory.

- **RAG Mode (Default):**

  ```bash
  askgit doc my_auth_summary "Summarize the implementation details of user authentication in the project."
  ```

  This will create a file named `my_auth_summary.md` in the `.askgit/docs/` directory.

- **Full Project Context Mode:**

  ```bash
  askgit doc project_overview_doc --whole "Provide a detailed project overview, including major modules and their relationships."
  ```

  This will create a file named `project_overview_doc.md` in the `.askgit/docs/` directory.

## Directory Structure

When you use AskGit within a Git repository, it creates a hidden `.askgit/` directory at the repository's root:

```
your_git_repo/
├── .git/
├── .askgit/
│   ├── config.ini      # Stores API configurations and model preferences
│   ├── db/             # Stores the FAISS vector database for RAG mode
│   │   ├── git_kb.faiss
│   │   └── git_kb.pkl
│   └── docs/           # Stores Markdown documents generated by the `doc` command
└── (Your code files and directories)
```

## Common Issues

- **`Error: This command must be run inside a git repository.`**
  Please ensure you are running `askgit.py` inside a directory managed by Git.

- **`Core Langchain/OpenAI libraries not found.`**
  Please run `pip install langchain langchain-openai faiss-cpu tiktoken python-dotenv configparser tqdm` to install all necessary dependencies.

- **RAG mode doesn't respond or gives irrelevant answers.**
  - Ensure you have run the `scan` command to build the knowledge base.
  - The knowledge base might be outdated. Rerun `scan` if your codebase has significant changes.
  - Your question might be too vague, leading to irrelevant retrieved context. Try a more specific question.
  - Check if your Embedding model configuration is correct.

- **Full Project Mode encounters a token limit error.**
  - Your project might be too large, exceeding the LLM's maximum context window.
  - In this case, it's strongly recommended to use the default RAG mode, as it only sends relevant code snippets to the LLM.
  - Try shorter questions, or configure the LLM to use a larger context model (if available).

- **API key or model configuration errors.**
  - Check if the API key and model names in `.askgit/config.ini` are correct.
  - Ensure your API key has permissions to access the selected model.

## Contributing

Contributions via Pull Requests or raising Issues are welcome!

---